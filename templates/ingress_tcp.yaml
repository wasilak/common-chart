{{- range $.Values.ports }}
{{- if eq .protocol "TCP" -}}
{{- if .nonHTTP -}}
{{- if eq (.ingressEnabled | default "true") "true" }}
---
apiVersion: traefik.io/v1alpha1
kind: IngressRouteTCP
metadata:
  name: "{{ include "fullname" $ }}-{{ .name }}-tcp"
  {{- include "annotations" $ | indent 2 }}
  {{- include "labels" $ | indent 2 }}
spec:
  entryPoints:
    - {{ .entryPoint | default (print "tcp") }}
  routes:
  - match: HostSNI(`*`)
    services:
    - name: "{{ include "fullname" $ }}"
      port: "{{ .name }}"
      nativeLB: true
{{- end -}}
{{- end -}}
{{- end -}}
{{- end -}}
